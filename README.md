# Vault Engine SDK Docuemtation

By integrating with Vault Engine, devlopers can effecivly introduce a plug and play backend to your application, largly side stepping responsibility of devloping, managing, and maintaining many of the essential backend features critical to blockchain dapp devlopment. A more percise overview of features is avaliable and why you should consider Vault Engine for you DAPP checkout vaultwallet.io/VaultEngineSDK


## Getting Started

These instructions will get you give you the resources needed to integrate Vault Engine into your product design roadmap, as well as begin devlopment. 

### ~Installing~ **Need actual bash/cmd install steps**Exculude from production
-None yet

## Usage in React Native - Exculude from production
### Import the module(s)
```
import Vault from 'vault-wrapper';
import { DeviceEventEmitter } from 'react-native';
```
### Vault Engine Primitive Concepts
#### User Accounts 
A user account is created using a unique identifer generated by some kind of authentication mechanism, here oAUTH. You can think of a user account as the parent to all other data. On the Vault Engine Server a user account is used to associate public keys with human readable names, allowing seamless crpyto user experiences. Additionally it is reccomended that a recover neumonic is generated to be assoicated with the user account. By doing this future private key pairs (Key Accounts) will be recoverable easily by the end user. When a user account is deleted from a device, the sdk deletes all local information assoicated with that user account, such as private/public keys, cached transaction information, etc. 

#### Key Accounts 
Within the Vault Engine SDK key accounts are the name for a public + private key pair and the associated metadata included along with them. Conceptually, you can think of this as a child object of a User Account, because each key account is assoicated with a User. 

#### Shared Accounts
A shared account is type of key account in which the public key is publically avaliable to other app users via a 'connection'. Unlike a default key account, this type of account, and its assoicated stored coins, will be both visable to your connections; as well as the endpoint which others will transact to. For example if two users were to wish to transact using Shared Accounts, each person would see and trasact to each other persons shared account (think abstracted public key). 
#### Connections
Connections can be thought of as 'friends'. Using this feature of the SDK allows abstraction of public keys and surfacing of simple human readable account names associated defintivly with users. Akin to social features, connections can be sent, recieved, accepted, and denied. A master list of all connection names (users) is stored in the Vault Engine cloud backend so each instance can query a live list.  

### User Accounts and Authentication
#### Add/Update Account

Need more details onwhat the account is. Like is this the account that you AUTH into locally, or the 'account' used on the cloud to identify the user? What is jwt, where is userId initalized/come from? On the backend what actions does this call peform for the 'account'? does it generate the wallet for the account etc? 

```
vault.addAccount(jwt, userId, name, email)
```
#### Remove Account

Will resolve with clarity on the question above. 
```
vault.removeAccount()
```
#### Check Account

What does this return? Is this simply a boolean yes no the account exists?

```
VaultWallet.hasAccount((cb) => {
  if (cb) {
    console.log("we have an account")
  } else {
    console.log("we dont have an account")
  }
})
```
### Shared Accounts
#### Share an account

Will need to have a section on the concept/behavior of shared accounts. Design idea behind this. 

```
vault.shareAccount(userId, walletAccount)
```
#### Unshare an account
```
vault.unshareAccount(userId, walletAccount)
````
#### Get all shared accounts
**`SharedAccount` is an object representing the `public address`, `type`, `isMyAccount`, `nickname`and `userId`** -- All the accounts you share to others and the accounts shared to you

What does accounts shared with others mean? Is this addresses that are generated between you and a contact for the explict purpose of transacting? 
```
var sharedAccounts = vault.getSharedAccounts()
```
#### Observing shared accounts
```
vault.startObservingSharedAccounts(callback)
...
vault.stopObservingSharedAccounts(callback)
```
### Connections and Connection Management
#### Get all connections

These are the same as the shared connections? More details on whats going on here. 
```
var connections = vault.getConnections()
```
### Observing connections changes
```
vault.startObservingConnections(walletAccounts, callback)
...
vault.stopObservingConnections(callback)
```
#### Find a connection
```
vault.findConnection(searchQuery, callbackWithIds)
```
#### Add a connection
```
vault.addConnection(searchResultId)
```

#### Accept a connection request
```
vault.acceptConnectionRequest(userIdOrSearchResultId)
```
#### Decline a connection request
```
vault.declineConnectionRequest(userIdOrSearchResultId)
```
#### Get a pending connection request
```
var pendingRequests = vault.getPendingRequests()
```

#### Observe Pending Connection Requests
```
vault.startObservingConnectionsRequests(callback)
...
vault.stopObservingConnectionRequests(callback)
```

### Realtime Connectivity Status
#### Get current connected state

If you need to check if the wallet is currently connected to the blockchain through Vault Wallets backend servers use the following call. 

```
VaultWallet.isConnected(
  (connected) => {
    console.log("Connected: " + connected)
  }
);
```
#### Observing connected state
What are the potental states here? 
```
DeviceEventEmitter.addListener('connectionChange', function(e: Event) {
    console.log("Connected: " + e.connected)
})
```

### Account Managment
**`WalletAccount` is an object representing the `publicAddress`, `type` and `nickname`**

The following documentation is for managing accounts created by the user. 

#### Get all **my** wallet accounts 
By passing the public address of the account you can recieve information on the users accounts. (accounts = AUTH + wallets + contacts? need to define that)

This is public key? What information is passed back in that obj? 
```
VaultWallet.getWalletAccounts((walletAccounts) => {
  console.log(walletAccounts)
})
```
#### Observing **my** wallet accounts
To setup a listenter for one of your wallets, so that you can recieve notifcations of changes in wallet activity, use the following call. 

What are the exact conditions this is fired. Send/Recieve/TX pending etc? 

```
DeviceEventEmitter.addListener('WalletAccounts', function(e: Event) {
    console.log(e)
});
```


#### Delete/Stop tracking the account
```
vault.deleteAccount(walletAccount)
```
### Mnemonic
#### Generate a seed (word size can be 16, 20, 24, 28 or 32)
```
var generatedMnemonicSeed = vault.generateSeed(wordSize)
```
#### Import from seed (or generate). 
*This will register the `WalletAccount` automatically with the backend. The key alias can be public -- no need to treat it like a password.*
```
var keyAlias = vault.importMnemonic(menmonicString, addressIndex = 0)
```
### Get WalletAccount for KeyAlias
This returns the alias directly? 

```
val walletAccount = vault.getWalletAccount(keyAlias)
```
#### Get Public Address of a Mnemonic
*CryptoObject is used in conjunction with the SE/TEE to validate user biometric authentication ~(optional)~.*


*We are decomposing the key alias which has the public address of address 0 of the mnemonic*
```
val publicAddress = vault.getPublicAddress(mnemonicString, addressIndex = 0)
// OR
val publicAddress = vault.getPublicAddress(keyAlias, addressIndex = 0, cryptoObject?)
```

#### Generate Another wallet from a mnemonic
*Automatically add the account address to backend*
```
var publicAddress = vault.createWallet(keyAlias, nameOfWallet, addressIndex = 0, cryptoObject?)
// OR
var publicAddress = vault.createWallet(mnemonicString, nameOfWallet, addressIndex = 0, cryptoObject?)
```

### Get Transactions
```
var transactions = vault.getTransactions(walletAccounts)
```
### Observing transaction changes
This means, when the TX is in a block, when it is considered to have finality? or what exactly is reported here? 

```
vault.startObservingTransactions(walletAccounts, callback)
...
vault.stopObservingTransactions(callback)
```



### Send Transaction
Sign and send transaction directly to blockchain
```
vault.postTransaction(accountFromkeyAlias, toAddress, value, cyrptoObject?, callback)
```
### Backup
#### Show Mnemonic
```
vault.showMnemonic(keyAlias, cryptoObject?, callback)
```
#### Cloud backup
```
vault.cloudBackup(keyAlias, cryptoObject?, callback)
```
#### Import cloud backup
```
vault.importCloud()
```

## Versioning

We use [SemVer](http://semver.org/) for versioning. For the versions available, see the [tags on this repository](https://github.com/yoloswaglyfestyle/react-native-wrapper/project/tags). 

## Authors

* **Rahul Behera** - *Initial work* - [Vault Wallet](https://github.com/thebehera)

See also the list of [contributors](https://github.com/your/project/contributors) who participated in this project.

## License

This project is licensed under the [TBD] License - see the [LICENSE.md](LICENSE.md) file for details
